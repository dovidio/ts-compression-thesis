/*
 * This Java source file was generated by the Gradle 'init' task.
 */
package com.dovidio.tsbenchmark;

import org.junit.Assert;
import org.junit.Test;

import java.util.ArrayList;
import java.util.List;
import java.util.Random;

public class AppTest {

    @Test
    public void gorilla() throws Exception {
        TimeSeries timeSeries = generateTimeSeries();
        TimeSeries restored = Main.compressGorilla(timeSeries);
        Assert.assertEquals(timeSeries, restored);
    }

    @Test
    public void LZ4() throws Exception {
        TimeSeries timeSeries = generateTimeSeries();
        Main.compressLZ4(timeSeries);
    }

    @Test
    public void deflate() throws Exception {
        TimeSeries timeSeries = generateTimeSeries();
        Main.compressDeflate(timeSeries);
    }

    @Test
    public void Zstandard() throws Exception {
        TimeSeries timeSeries = generateTimeSeries();
        Main.compressZStandard(timeSeries);
    }

    private TimeSeries generateTimeSeries() {

        Random random = new Random();

        TimeSeries timeSeries = new TimeSeries("ts");
        int numberOfPoints = 35_000;
        List<DataPoint> dataPoints = new ArrayList<>(numberOfPoints);
        long now = System.currentTimeMillis();

        for (int i = 0; i < numberOfPoints; i++) {
            long timeStamp = now + 1000 * 60 * i;
            double value = random.nextDouble();
            dataPoints.add(new DataPoint(timeStamp, value));
        }
        timeSeries.dataPoints = dataPoints;

        return timeSeries;
    }
}
